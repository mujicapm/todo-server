(this.webpackJsonptodolist=this.webpackJsonptodolist||[]).push([[0],{102:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),r=a(22),s=a.n(r),o=a(6),i=a(2),d=a(55),j=a(113);function l(){return Object(j.a)(Date.now(),{year:"numeric",month:"numeric",day:"numeric"})}function u(e,t){switch(t.type){case"LOGIN":case"REGISTER":return{username:t.username,access_token:t.access_token};case"LOGOUT":return{username:void 0,access_token:void 0};default:return e}}function b(e,t){switch(t.type){case"CREATE_TODO":return[{id:t.id,title:t.title,description:t.description,dateCreated:t.dateCreated,isComplete:t.isComplete,dateComplete:t.dateComplete}].concat(Object(d.a)(e));case"TOGGLE_TODO":return t.isComplete?e.map((function(e){return e.id===t.id?Object(i.a)(Object(i.a)({},e),{},{isComplete:t.isComplete,dateComplete:l()}):e})):e.map((function(e){return e.id===t.id?Object(i.a)(Object(i.a)({},e),{},{isComplete:t.isComplete,dateComplete:null}):e}));case"DELETE_TODO":return e.filter((function(e){return e.id!==t.id}));case"FETCH_POSTS":return t.ToDoItems;default:return e}}function O(e,t){return{user:u(e.user,t),ToDoItems:b(e.ToDoItems,t)}}var h=a(9),p=a(107),m=a(110),x=a(108),f=(a(77),a(11)),C=a(111),v=a(109),g=a(106),w=a(1);function T(e){var t=e.show,a=e.handleClose,c=Object(n.useContext)(h.a).dispatch,r=Object(n.useState)({username:"",password:"",passwordRepeat:""}),s=Object(o.a)(r,2),d=s[0],j=s[1],l=Object(n.useState)(""),u=Object(o.a)(l,2),b=(u[0],u[1]),O=Object(f.b)((function(e,t){return{url:"/auth/register",method:"post",data:{username:e,password:t,passwordConfirmation:t}}})),p=Object(o.a)(O,2),m=p[0],x=p[1];return Object(n.useEffect)((function(){m&&m.data&&c({type:"REGISTER",username:m.data.username})}),[m]),Object(n.useEffect)((function(){m&&!1===m.isLoading&&(m.data||m.error)&&(m.error?(console.log(m),b("Registration failed, please try again later."),alert("fail")):(console.log(m),b("Registration successful. You may now login."),alert("success")))}),[m]),Object(w.jsx)(C.a,{show:t,onHide:a,children:Object(w.jsxs)(v.a,{onSubmit:function(e){e.preventDefault(),x(d.username,d.password),a()},children:[Object(w.jsx)(C.a.Header,{closeButton:!0,children:Object(w.jsx)(C.a.Title,{children:"Register"})}),Object(w.jsxs)(C.a.Body,{children:[Object(w.jsx)(v.a.Label,{htmlFor:"register-username",children:"Username:"}),Object(w.jsx)(v.a.Control,{type:"text",value:d.username,onChange:function(e){return j(Object(i.a)(Object(i.a)({},d),{},{username:e.target.value}))},name:"register-username",id:"register-username"}),Object(w.jsx)(v.a.Label,{htmlFor:"register-password",children:"Password:"}),Object(w.jsx)(v.a.Control,{type:"password",value:d.password,onChange:function(e){return j(Object(i.a)(Object(i.a)({},d),{},{password:e.target.value}))},name:"register-password",id:"register-password"}),Object(w.jsx)(v.a.Label,{htmlFor:"register-password-repeat",children:"Repeat password:"}),Object(w.jsx)(v.a.Control,{type:"password",value:d.passwordRepeat,onChange:function(e){return j(Object(i.a)(Object(i.a)({},d),{},{passwordRepeat:e.target.value}))},name:"register-password-repeat",id:"register-password-repeat"})]}),Object(w.jsxs)(C.a.Footer,{children:[Object(w.jsx)(g.a,{variant:"secondary",onClick:a,children:"Cancel"}),Object(w.jsx)(g.a,{variant:"primary",type:"submit",disabled:0===d.username.length||0===d.password.length||d.password!==d.passwordRepeat,children:"Register"})]})]})})}function y(e){var t=e.show,a=e.handleClose,c=Object(n.useContext)(h.a).dispatch,r=Object(n.useState)(""),s=Object(o.a)(r,2),i=s[0],d=s[1],j=Object(n.useState)(""),l=Object(o.a)(j,2),u=l[0],b=l[1],O=Object(n.useState)(!1),p=Object(o.a)(O,2),m=p[0],x=p[1];var T=Object(f.b)((function(e,t){return{url:"auth/login",method:"post",data:{username:e,password:t}}})),y=Object(o.a)(T,2),k=y[0],E=y[1];return Object(n.useEffect)((function(){k&&!1===k.isLoading&&(k.data||k.error)&&(k.error?(x(!0),alert("failed")):(x(!1),console.log(k.data),c({type:"LOGIN",username:i,access_token:k.data.access_token})))}),[k]),Object(w.jsx)(C.a,{show:t,onHide:a,children:Object(w.jsxs)(v.a,{onSubmit:function(e){e.preventDefault(),E(i,u),a()},children:[Object(w.jsx)(C.a.Header,{closeButton:!0,children:Object(w.jsx)(C.a.Title,{children:"Login"})}),Object(w.jsxs)(C.a.Body,{children:[Object(w.jsx)(v.a.Label,{htmlFor:"login-username",children:"Username:"}),Object(w.jsx)(v.a.Control,{type:"text",value:i,onChange:function(e){d(e.target.value)},name:"login-username",id:"login-username"}),Object(w.jsx)(v.a.Label,{htmlFor:"login-password",children:"Password:"}),Object(w.jsx)(v.a.Control,{type:"password",value:u,onChange:function(e){b(e.target.value)},name:"login-password",id:"login-password"}),m&&Object(w.jsx)(v.a.Text,{style:{color:"red"},children:"Invalid username or password"})]}),Object(w.jsxs)(C.a.Footer,{children:[Object(w.jsx)(g.a,{variant:"secondary",onClick:a,children:"Cancel"}),Object(w.jsx)(g.a,{variant:"primary",disabled:0===i.length,type:"submit",children:"Login"})]})]})})}function k(){var e=c.a.lazy((function(){return Promise.resolve().then(a.bind(null,77))})),t=Object(n.useContext)(h.a).state,r=Object(n.useState)(!1),s=Object(o.a)(r,2),i=s[0],d=s[1],j=Object(n.useState)(!1),l=Object(o.a)(j,2),u=l[0],b=l[1];return t.user.username?Object(w.jsx)(e,{}):Object(w.jsxs)("div",{className:"justify-content-end",children:[Object(w.jsx)(g.a,{variant:"link",onClick:function(e){return d(!0)},children:"Login"}),Object(w.jsx)(y,{show:i,handleClose:function(){return d(!1)}}),Object(w.jsx)(g.a,{variant:"link",onClick:function(e){return b(!0)},children:"Register"}),Object(w.jsx)(T,{show:u,handleClose:function(){return b(!1)}})]})}var E=a(70),D=a(13);function L(e){Object(E.a)(e);var t=Object(n.useContext)(h.a),a=t.state,c=t.dispatch,r=Object(n.useState)(""),s=Object(o.a)(r,2),i=s[0],d=s[1],j=Object(n.useState)(""),u=Object(o.a)(j,2),b=u[0],O=u[1],p=Object(n.useState)(""),m=Object(o.a)(p,2),x=m[0],C=m[1],v=Object(f.b)((function(e){var t=e.title,n=e.description,c=e.dateCreated,r=e.isComplete,s=e.dateComplete;return{url:"/todo",method:"post",headers:{Authorization:"".concat(a.user.access_token)},data:{title:t,description:n,dateCreated:c,isComplete:r,dateComplete:s}}})),g=Object(o.a)(v,2),T=g[0],y=g[1],k=Object(D.d)();function L(e){e.preventDefault(),y({title:i,description:b,dateCreated:x,isComplete:!1,dateComplete:null}),d(""),O("")}return Object(n.useEffect)((function(){T&&T.data&&(c({type:"CREATE_TODO",id:T.data.id,title:T.data.title,description:T.data.description,dateCreated:T.data.dateCreated,isComplete:T.data.isComplete,dateComplete:T.data.dateComplete}),console.log(T.data),k.navigate("/todo/".concat(T.data.id)))}),[T]),Object(w.jsxs)("form",{onSubmit:function(e){L(e)},children:[Object(w.jsxs)("div",{children:[Object(w.jsx)("label",{htmlFor:"create-title",children:"Title:"}),Object(w.jsx)("input",{type:"text",value:i,onChange:function(e){d(e.target.value)},name:"create-title",id:"create-title"})]}),Object(w.jsxs)("div",{children:[Object(w.jsx)("label",{htmlFor:"create-description",children:"Description:"}),Object(w.jsx)("input",{type:"textarea",value:b,onChange:function(e){O(e.target.value)},name:"create-description",id:"create-description",rows:"5",cols:"33"})]}),Object(w.jsx)("input",{type:"submit",value:"Create",onClick:function(){C(l())},name:"create"})]})}var S=function(e){var t=e.text;return Object(w.jsx)(D.a,{href:"/",children:Object(w.jsx)(m.a.Brand,{children:t})})};function R(){var e=Object(n.useContext)(h.a).state.user;return Object(w.jsx)(m.a,{bg:"light",expand:"lg",children:Object(w.jsxs)(p.a,{children:[Object(w.jsx)(m.a.Brand,{href:"/",children:Object(w.jsx)(S,{text:"My ToDos"})}),Object(w.jsx)(m.a.Toggle,{"aria-controls":"basic-navbar-nav"}),Object(w.jsxs)(m.a.Collapse,{id:"basic-navbar-nav",children:[Object(w.jsx)(x.a,{className:"me-auto",children:e.username&&Object(w.jsx)(x.a.Link,{children:Object(w.jsx)(D.a,{href:"/todo/create",children:"Create New Task"})})}),Object(w.jsx)(c.a.Suspense,{fallback:"Loading...",children:Object(w.jsx)(k,{})})]})]})})}var I=a(112);function _(e){var t=e.id,a=e.title,c=e.description,r=e.dateCreated,s=e.isComplete,i=e.dateComplete,d=e.short,j=void 0!==d&&d,u=Object(n.useContext)(h.a).dispatch,b=Object(f.b)((function(e){return{url:"/ToDoItems/".concat(encodeURI(e)),method:"delete"}})),O=Object(o.a)(b,2),p=(O[0],O[1]);var m=Object(f.b)((function(e,t,a){return{url:"/ToDoItems/".concat(encodeURI(e)),method:"patch",data:{isComplete:t,dateComplete:a}}})),x=Object(o.a)(m,2),C=(x[0],x[1]);var v=c;return j&&c.length>30&&(v=c.substring(0,30)+"..."),Object(w.jsx)(I.a,{children:Object(w.jsxs)(I.a.Body,{children:[Object(w.jsx)(I.a.Title,{children:Object(w.jsx)(D.a,{href:"/todo/".concat(t),children:Object(w.jsx)("h3",{children:a})})}),Object(w.jsxs)(I.a.Text,{children:[Object(w.jsx)("div",{children:v}),Object(w.jsx)("br",{}),Object(w.jsxs)("i",{children:["Created on ",r]}),Object(w.jsxs)("div",{children:[Object(w.jsx)("label",{htmlFor:"item-complete",children:"Complete:"}),Object(w.jsx)("input",{type:"checkbox",name:"item-complete",id:"item-complete",value:"0",checked:s,onChange:function(e){s||(i=l()),u({type:"TOGGLE_TODO",id:t,isComplete:!s}),C(t,!s,i)}}),Object(w.jsx)("button",{onClick:function(e){p(t),u({type:"DELETE_TODO",id:t})},children:"Delete Post"}),s&&Object(w.jsxs)("span",{style:{color:"blue"},children:[Object(w.jsx)("br",{}),Object(w.jsxs)("i",{children:["Completed on: ",i]}),Object(w.jsx)("br",{})]}),j&&Object(w.jsxs)("div",{children:[Object(w.jsx)("br",{}),Object(w.jsx)(D.a,{href:"/todo/".concat(t),children:"View Full Task"})]})]})]})]})})}function F(){var e=Object(n.useContext)(h.a).state.ToDoItems;return Object(w.jsx)("div",{children:e.map((function(e,t){return Object(n.createElement)(_,Object(i.a)(Object(i.a)({},e),{},{short:!0,title:e.title,description:e.description,key:"ToDoItem-"+t,id:e.id}))}))})}function G(){var e=Object(n.useContext)(h.a),t=e.state,a=e.dispatch,c=Object(f.b)((function(){return{url:"/todo",method:"get",headers:{Authorization:"".concat(t.user.access_token)}}})),r=Object(o.a)(c,2),s=r[0],i=r[1];Object(n.useEffect)((function(){i()}),[t.user.access_token]),Object(n.useEffect)((function(){s&&!1===s.isLoading&&s.data&&(console.log(s.data),a({type:"FETCH_POSTS",ToDoItems:s.data.ToDoItems}))}),[s]);s.data;var d=s.isLoading;return Object(w.jsxs)(w.Fragment,{children:[d&&"Tasks are loading..."," ",Object(w.jsx)(F,{})]})}var B=a(10);function P(e){var t=e.id,a=Object(n.useContext)(h.a).state,c=Object(f.b)((function(){return{url:"/todo/".concat(t),headers:{Authorization:"".concat(a.user.access_token)},method:"get"}})),r=Object(o.a)(c,2),s=r[0],d=r[1];return Object(n.useEffect)(d,[t]),Object(w.jsxs)("div",{children:[s&&s.data?Object(w.jsx)(_,Object(i.a)({},s.data)):"Loading...",Object(w.jsx)("div",{children:Object(w.jsx)(D.a,{href:"/",children:"Go back"})})]})}var U=function(){var e=Object(n.useReducer)(O,{user:{},ToDoItems:[]}),t=Object(o.a)(e,2),a=t[0],c=t[1],r=Object(B.f)({"/":Object(B.g)({view:Object(w.jsx)(G,{})}),"/todo/create":Object(B.g)({view:Object(w.jsx)(L,{})}),"/todo/:id":Object(B.g)((function(e){return{view:Object(w.jsx)(P,{id:e.params.id})}}))});return Object(w.jsx)("div",{children:Object(w.jsx)(h.a.Provider,{value:{state:a,dispatch:c},children:Object(w.jsx)(D.b,{routes:r,children:Object(w.jsxs)(p.a,{children:[Object(w.jsx)(R,{}),Object(w.jsx)("hr",{}),Object(w.jsx)(D.c,{})]})})})})},H=a(37),A=a.n(H).a.create({baseURL:"/"});s.a.render(Object(w.jsx)(c.a.StrictMode,{children:Object(w.jsx)(f.a,{value:A,children:Object(w.jsx)(U,{})})}),document.getElementById("root"))},77:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return s}));var n=a(0),c=a(9),r=a(1);function s(){var e=Object(n.useContext)(c.a),t=e.state,a=e.dispatch,s=t.user;return Object(r.jsxs)("form",{onSubmit:function(e){e.preventDefault(),a({type:"LOGOUT"})},children:["Logged in as: ",Object(r.jsx)("b",{children:s.username}),Object(r.jsx)("input",{type:"submit",value:"Logout"})]})}},9:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(0),c=a.n(n).a.createContext({state:{},dispatch:function(){}})}},[[102,1,2]]]);
//# sourceMappingURL=main.f3735194.chunk.js.map